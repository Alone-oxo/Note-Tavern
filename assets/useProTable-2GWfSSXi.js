import{d as I,c as _,e as D,f as a,w as o,i as U,t as ae,z as T,a1 as z,C as oe,ao as ne,F as O,y as te,W as Z,ad as Le,ap as xe,k as re,q as K,s as X,h as v,_ as M,r as V,A as ie,B as ue,m as G,D as J,l as de,L as N,ai as ve,aq as be,ah as ce,ar as ye,as as je,b as ee,at as Ae,o as Me,X as we,p as x,au as B,av as qe,R as Ce,aw as Se,x as L,ax as $e,ay as ke,E,az as pe,aA as Ue,ac as me,j as se,aB as Oe,aC as Ne,aD as We,ae as Ve,u as He,aE as Ye}from"./index-BmhWhEkA.js";/* empty css                        *//* empty css                  *//* empty css               *//* empty css                  */import{r as j}from"./el-notification-Cs9pN3cw.js";/* empty css                 */import{_ as Pe}from"./el-drawer-CsmQuTVe.js";import"./loading-BA-LxNaM.js";/* empty css                 */import{f as Ze,a as Ke}from"./index-CYhU1832.js";const Xe=s=>(K("data-v-aa68f9eb"),s=s(),X(),s),Ge=Xe(()=>v("i",{class:Z("iconfont icon-yiwen")},null,-1)),Je=I({__name:"SearchItem",props:{column:{},searchParam:{}},setup(s){return(l,t)=>{var y;const c=Le,g=xe,m=re;return _(),D("div",{class:Z(["grid-item",{"full-width":(y=l.column.search)==null?void 0:y.isFullWidth}])},[a(m,{prop:l.column.prop},{label:o(()=>[a(g,{size:4},{default:o(()=>{var h;return[U(ae(l.column.label)+" ",1),(h=l.column.search)!=null&&h.tooltip?(_(),T(c,{key:0,content:l.column.search.tooltip,effect:"dark",placement:"top"},{default:o(()=>[Ge]),_:1},8,["content"])):z("",!0),U(" : ")]}),_:1})]),default:o(()=>{var h,u,r;return[(_(),T(oe(((h=l.column.search)==null?void 0:h.render)??`el-${(u=l.column.search)==null?void 0:u.el}`),ne({searchParam:l.searchParam,type:"datetimerange"},(r=l.column.search)==null?void 0:r.props,{modelValue:l.searchParam[l.column.prop],"onUpdate:modelValue":t[0]||(t[0]=w=>l.searchParam[l.column.prop]=w)}),{default:o(()=>{var w;return[((w=l.column.search)==null?void 0:w.el)==="select"?(_(!0),D(O,{key:0},te(l.column.search.option,(S,d)=>(_(),T(oe("el-option"),{key:d,label:S.label,value:S.value},null,8,["label","value"]))),128)):z("",!0)]}),_:1},16,["searchParam","modelValue"]))]}),_:1},8,["prop"])],2)}}}),Qe=M(Je,[["__scopeId","data-v-aa68f9eb"]]),ea={class:"card mb10 table-search"},aa={class:"grid-main"},ta={class:"button-grid"},la={class:"button-main"},oa=I({__name:"index",props:{columns:{},searchParam:{}},setup(s,{emit:l}){const t=l,c=V(),g=V(!0),m=()=>{t("updateSearchParam")},y=h=>{h&&(h.resetFields(),t("resetSearchParam"))};return(h,u)=>{const r=Qe,w=G,S=J,d=de;return _(),D("div",ea,[a(d,{ref_key:"searchFormRef",ref:c,model:h.searchParam},{default:o(()=>[v("div",aa,[(_(!0),D(O,null,te(h.columns,p=>{var e;return ie((_(),T(r,{column:p,"search-param":h.searchParam},null,8,["column","search-param"])),[[ue,!((e=p.search)!=null&&e.isCollapsed&&g.value)]])}),256)),v("div",ta,[v("div",la,[a(w,{type:"primary",icon:"Search",onClick:u[0]||(u[0]=p=>m())},{default:o(()=>[U(" 搜索 ")]),_:1}),a(w,{icon:"Delete",onClick:u[1]||(u[1]=p=>y(c.value))},{default:o(()=>[U(" 重置 ")]),_:1}),a(w,{type:"primary",link:"",onClick:u[2]||(u[2]=p=>g.value=!g.value)},{default:o(()=>[U(ae(g.value?"展开":"合并")+" ",1),a(S,{class:"el-icon--right"},{default:o(()=>[(_(),T(oe(g.value?"ArrowDown":"ArrowUp")))]),_:1})]),_:1})])])])]),_:1},8,["model"])])}}}),na=M(oa,[["__scopeId","data-v-ec67c183"]]),Te=s=>(K("data-v-a773bb89"),s=s(),X(),s),sa={class:"table-main"},ra=Te(()=>v("img",{src:Pe,alt:"notData"},null,-1)),ia=Te(()=>v("div",null,"暂无可配置列",-1)),ua=I({name:"ColSetting"}),da=I({...ua,props:{colSetting:{default:[]}},setup(s,{expose:l}){const t=s,c=N(()=>t.colSetting.length===0),g=V(!1);return l({openColSetting:()=>{g.value=!0}}),(y,h)=>{const u=be,r=ce,w=ye,S=ve;return _(),T(S,{modelValue:g.value,"onUpdate:modelValue":h[0]||(h[0]=d=>g.value=d),title:"列设置",size:"450px"},{default:o(()=>[v("div",sa,[a(w,{data:y.colSetting,border:!0,class:Z({removeElFlex:!c.value})},{empty:o(()=>[ra,ia]),default:o(()=>[a(u,{prop:"label",align:"center",label:"列名"}),a(u,{prop:"isShow",align:"center",label:"显示"},{default:o(d=>[a(r,{modelValue:d.row.isShow,"onUpdate:modelValue":p=>d.row.isShow=p},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(u,{prop:"sortable",align:"center",label:"排序"},{default:o(d=>[a(r,{modelValue:d.row.sortable,"onUpdate:modelValue":p=>d.row.sortable=p},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data","class"])])]),_:1},8,["modelValue"])}}}),ca=M(da,[["__scopeId","data-v-a773bb89"]]),pa=I({name:"Pagination"}),ma=I({...pa,props:{pageable:{},handleSizeChange:{type:Function},handleCurrentChange:{type:Function}},setup(s){return(l,t)=>{const c=je;return _(),T(c,{background:!0,"current-page":l.pageable.pageNum,"page-size":l.pageable.pageSize,"page-sizes":[10,25,50,100],total:l.pageable.total,size:"default",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:l.handleSizeChange,onCurrentChange:l.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])}}}),_a=M(ma,[["__scopeId","data-v-c22a85a7"]]),fa=s=>j({url:"user/list",method:"post",data:s,headers:{"Content-Type":"application/json"}}),ga=s=>j({url:"/user/add",method:"post",data:s,headers:{"Content-Type":"application/json"}}),ha=s=>j({url:"/user/import",method:"post",data:s,headers:{"Content-Type":"application/json"}}),va=s=>j({url:"/user/edit",method:"post",data:s,headers:{"Content-Type":"application/json"}}),ba=s=>j({url:"/user/rest_password",method:"post",data:s,headers:{"Content-Type":"application/json"}}),ge=s=>j({url:"user/delete",method:"post",data:s,headers:{"Content-Type":"application/json"}}),ya=s=>j({url:"user/change",method:"post",data:s,headers:{"Content-Type":"application/json"}}),he=s=>j({url:"geeker/user/export",method:"post",data:s,headers:{"Content-Type":"application/json"},responseType:"blob"}),wa=({initParam:s})=>{const l=ee({tableData:[],pageable:{pageNum:1,pageSize:10,total:0},searchParam:{...s},searchInitParam:{},totalParam:{}}),t=N(()=>({pageNum:l.pageable.pageNum,pageSize:l.pageable.pageSize})),c=()=>{l.totalParam={};let u={};for(let r in l.searchParam)(l.searchParam[r]||l.searchParam[r]===!1||l.searchParam[r]===0)&&(u[r]=l.searchParam[r]);Object.assign(l.totalParam,u),m()},g=()=>{l.pageable.pageNum=1,l.searchParam={},Object.assign(l.searchParam,s),c()},m=async()=>{var e,i;let u="",r="";Object.assign(l.totalParam,t.value,l.searchParam),(e=l.totalParam)!=null&&e.createTime&&([u,r]=(i=l.totalParam)==null?void 0:i.createTime,delete l.totalParam.createTime,l.totalParam.startTime=u,l.totalParam.endTime=r);const{data:{list:w,pageNum:S,pageSize:d,total:p}}=await fa(Ze(l.totalParam));l.tableData=w,l.pageable.pageNum=S,l.pageable.pageSize=d,l.pageable.total=p},y=u=>{l.pageable.pageNum=1,l.pageable.pageSize=u,m()},h=u=>{l.pageable.pageNum=u,m()};return{...Ae(l),pageParam:t,getTableList:m,updateSearchParam:c,resetSearchParam:g,handleSizeChange:y,handleCurrentChange:h}},De=s=>(K("data-v-8b06ab54"),s=s(),X(),s),Ca={class:"card table-main"},Sa={class:"table-header"},$a={class:"header-button-lf"},ka={key:0,class:"header-button-ri"},Ua={key:1},Va=De(()=>v("img",{src:Pe,alt:"notData"},null,-1)),Pa=De(()=>v("div",null,"暂无数据",-1)),Ta=I({__name:"index",props:{columns:{},toolButton:{type:[Array,Boolean],default:!0},pagination:{type:Boolean,default:!0}},setup(s,{expose:l}){const t=$=>qe($).format("YYYY-MM-DD HH:mm:ss"),c=new Date,m=[t(new Date().setFullYear(c.getFullYear()-1)),t(c)],{tableData:y,pageable:h,searchParam:u,updateSearchParam:r,resetSearchParam:w,getTableList:S,handleSizeChange:d,handleCurrentChange:p}=wa({initParam:{createTime:m}}),e=s;Me(()=>{S()});const i=ee(e.columns),n=V(!0),f=N(()=>e.columns.filter($=>$.search)),k=$=>Array.isArray(e.toolButton)?e.toolButton.includes($):e.toolButton,C=V(),P=ee(i.filter($=>$.prop).map($=>({...$,isShow:$.isShow??!0,sortable:$.sortable??!1}))),b=()=>C.value.openColSetting();we(P,$=>{$.forEach(W=>{const H=i.find(Y=>Y.prop===W.prop);H&&(H.isShow=W.isShow,H.sortable=W.sortable)})},{deep:!0});const F=V(),q=V([]),A=N(()=>q.value.map($=>$.id)),le=N(()=>q.value.length===0),Re=$=>{q.value=$};return l({searchParam:u,clearSelection:()=>F.value.clearSelection(),getTableList:S}),($,W)=>{const H=na,Y=G,Fe=be,Be=ye;return _(),D(O,null,[ie(a(H,{columns:f.value,searchParam:x(u),onUpdateSearchParam:x(r),onResetSearchParam:x(w)},null,8,["columns","searchParam","onUpdateSearchParam","onResetSearchParam"]),[[ue,n.value]]),v("div",Ca,[v("div",Sa,[v("div",$a,[B($.$slots,"tableHeader",{isDisabled:le.value,selectedListIds:A.value},void 0,!0)]),$.toolButton?(_(),D("div",ka,[B($.$slots,"toolButton",{},()=>[k("refresh")?(_(),T(Y,{key:0,icon:"Refresh",circle:"",onClick:x(S)},null,8,["onClick"])):z("",!0),k("setting")?(_(),T(Y,{key:1,icon:"Operation",circle:"",onClick:b})):z("",!0),k("search")?(_(),T(Y,{key:2,icon:"Search",circle:"",onClick:W[0]||(W[0]=R=>n.value=!n.value)})):z("",!0)],!0)])):z("",!0)]),a(Be,{border:"",ref_key:"tableRef",ref:F,data:x(y),onSelectionChange:Re},{empty:o(()=>[Va,Pa]),default:o(()=>[(_(!0),D(O,null,te(i,R=>(_(),D(O,{key:R.prop},[R.isShow??!0?(_(),T(Fe,ne({key:0,ref_for:!0},R,{align:R.align??"center","show-overflow-tooltip":R.showOverflowTooltip??R.prop!=="operation",sortable:R.sortable??!1}),{default:o(fe=>[R.slotRender?B($.$slots,R.slotRender,ne({key:0,ref_for:!0},fe),void 0,!0):z("",!0),R.render?(_(),D("span",Ua,ae(R.render(fe)),1)):z("",!0)]),_:2},1040,["align","show-overflow-tooltip","sortable"])):z("",!0)],64))),128))]),_:3},8,["data"]),B($.$slots,"pagination",{},()=>[$.pagination?(_(),T(_a,{key:0,pageable:x(h),"handle-size-change":x(d),"handle-current-change":x(p)},null,8,["pageable","handle-size-change","handle-current-change"])):z("",!0)],!0)]),$.toolButton?(_(),T(ca,{key:0,ref_key:"colRef",ref:C,"col-setting":P},null,8,["col-setting"])):z("",!0)],64)}}}),Da=M(Ta,[["__scopeId","data-v-8b06ab54"]]),ze=s=>j({url:"/file/upload/img",method:"post",data:s,headers:{"Content-Type":"application/json"}}),_e=s=>(K("data-v-c3f88840"),s=s(),X(),s),za={class:"upload-box"},Ea=["src"],Ia=_e(()=>v("span",null,"编辑",-1)),Ra=_e(()=>v("span",null,"查看",-1)),Fa=_e(()=>v("span",null,"删除",-1)),Ba={key:1,class:"upload-empty"},La={class:"el-upload__tip"},xa=I({__name:"UploadImage",props:{imageUrl:{default:""},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:imageUrl"],setup(s,{emit:l}){ke(e=>({"21976f12":e.width,"10f10d4a":e.height,"02afed12":e.borderRadius}));const t=s,c=l,g=Ce(Se,void 0),m=N(()=>t.disabled||(g==null?void 0:g.disabled)),y=V("id-"+Ke()),h=async e=>{let i=new FormData;i.append("file",e.file);try{const n=t.api??ze,{data:f}=await n(i);e.onSuccess(f)}catch(n){e.onError(n)}},u=(e,i)=>{e&&(c("update:imageUrl",e.fileUrl),E({title:"温馨提示",message:"图片上传成功！",type:"success"}))},r=()=>{E({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})},w=e=>{const i=e.size/1024/1024<t.fileSize,n=t.fileType.includes(e.type);return n?i||E({title:"温馨提示",message:`上传图片大小不能超过 ${t.fileSize}M！`,type:"warning"}):E({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),n&&i},S=()=>{const e=document.querySelector(`#${y.value} .el-upload__input`);e&&e.dispatchEvent(new MouseEvent("click"))},d=V(!1),p=()=>{c("update:imageUrl","")};return(e,i)=>{const n=L("Edit"),f=J,k=L("ZoomIn"),C=L("Delete"),P=L("Plus"),b=pe,F=Ue;return _(),D("div",za,[a(b,{id:y.value,accept:e.fileType.join(","),"show-file-list":!1,"http-request":h,"before-upload":w,"on-success":u,"on-error":r,drag:e.drag,disabled:m.value,class:Z([{disabled:m.value}])},{default:o(()=>[e.imageUrl?(_(),D(O,{key:0},[v("img",{src:e.imageUrl,class:"upload-image"},null,8,Ea),v("div",{class:"upload-handle",onClick:i[1]||(i[1]=$e(()=>{},["stop"]))},[m.value?z("",!0):(_(),D("div",{key:0,class:"handle-icon",onClick:S},[a(f,null,{default:o(()=>[a(n)]),_:1}),Ia])),v("div",{class:"handle-icon",onClick:i[0]||(i[0]=q=>d.value=!0)},[a(f,null,{default:o(()=>[a(k)]),_:1}),Ra]),m.value?z("",!0):(_(),D("div",{key:1,class:"handle-icon",onClick:p},[a(f,null,{default:o(()=>[a(C)]),_:1}),Fa]))])],64)):(_(),D("div",Ba,[B(e.$slots,"empty",{},()=>[a(f,null,{default:o(()=>[a(P)]),_:1})],!0)]))]),_:3},8,["id","accept","drag","disabled","class"]),v("div",La,[B(e.$slots,"tip",{},void 0,!0)]),d.value?(_(),T(F,{key:0,"url-list":[e.imageUrl],onClose:i[2]||(i[2]=q=>d.value=!1)},null,8,["url-list"])):z("",!0)])}}}),ja=M(xa,[["__scopeId","data-v-c3f88840"]]),Ee=s=>(K("data-v-9c5d8182"),s=s(),X(),s),Aa={class:"upload-box"},Ma={class:"upload-empty"},qa=["src"],Oa=["onClick"],Na=Ee(()=>v("span",null,"查看",-1)),Wa=["onClick"],Ha=Ee(()=>v("span",null,"删除",-1)),Ya={class:"el-upload__tip"},Za=I({__name:"UploadImages",props:{fileList:{default:()=>[]},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},limit:{default:5},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:fileList"],setup(s,{emit:l}){ke(n=>({"23ca0378":n.width,"89145f2e":n.height,"824f7cc0":n.borderRadius}));const t=s,c=Ce(Se,void 0),g=N(()=>t.disabled||(c==null?void 0:c.disabled)),m=V(t.fileList);we(()=>t.fileList,n=>{m.value=n});const y=l,h=async n=>{let f=new FormData;f.append("file",n.file);try{const k=t.api??ze,{data:C}=await k(f);n.onSuccess(C)}catch(k){n.onError(k)}},u=()=>{E({title:"温馨提示",message:`当前最多只能上传 ${t.limit} 张图片，请移除后上传！`,type:"warning"})},r=(n,f)=>{n&&(f.url=n.fileUrl,y("update:fileList",m.value),E({title:"温馨提示",message:"图片上传成功！",type:"success"}))},w=()=>{E({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})},S=n=>{const f=n.size/1024/1024<t.fileSize,k=t.fileType.includes(n.type);return k?f||E({title:"温馨提示",message:`上传图片大小不能超过 ${t.fileSize}M！`,type:"warning"}):E({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),k&&f},d=V(""),p=V(!1),e=n=>{d.value=n.url,p.value=!0},i=n=>{m.value=m.value.filter(f=>f.url!==n.url||f.name!==n.name),y("update:fileList",m.value)};return(n,f)=>{const k=L("Plus"),C=J,P=L("ZoomIn"),b=L("Delete"),F=pe,q=Ue;return _(),D("div",Aa,[a(F,{drag:n.drag,disabled:g.value,multiple:!0,accept:n.fileType.join(","),"file-list":m.value,"onUpdate:fileList":f[1]||(f[1]=A=>m.value=A),"list-type":"picture-card",limit:n.limit,"http-request":h,"before-upload":S,"on-exceed":u,"on-success":r,"on-error":w,class:Z([{disabled:g.value}])},{file:o(({file:A})=>[v("img",{src:A.url,class:"upload-image"},null,8,qa),v("div",{class:"upload-handle",onClick:f[0]||(f[0]=$e(()=>{},["stop"]))},[v("div",{class:"handle-icon",onClick:le=>e(A)},[a(C,null,{default:o(()=>[a(P)]),_:1}),Na],8,Oa),g.value?z("",!0):(_(),D("div",{key:0,class:"handle-icon",onClick:le=>i(A)},[a(C,null,{default:o(()=>[a(b)]),_:1}),Ha],8,Wa))])]),default:o(()=>[v("div",Ma,[B(n.$slots,"empty",{},()=>[a(C,null,{default:o(()=>[a(k)]),_:1})],!0)])]),_:3},8,["drag","disabled","accept","file-list","limit","class"]),v("div",Ya,[B(n.$slots,"tip",{},void 0,!0)]),p.value?(_(),T(q,{key:0,"url-list":[d.value],onClose:f[2]||(f[2]=A=>p.value=!1)},null,8,["url-list"])):z("",!0)])}}}),Ka=M(Za,[["__scopeId","data-v-9c5d8182"]]),Xa=[{label:"男",value:1},{label:"女",value:2}],Ga=v("span",null,"请上传头像",-1),Ja=v("span",null,"请上传照片",-1),Qa=I({name:"UserDrawer"}),et=I({...Qa,setup(s,{expose:l}){const t=V({title:"",row:{},isView:!1}),c=V(!1),g=u=>{t.value=u,c.value=!0},m=ee({avatar:[{required:!0,message:"请上传用户头像"}],photo:[{required:!0,message:"请上传用户照片"}],username:[{required:!0,message:"请填写用户姓名"}],gender:[{required:!0,message:"请选择性别"}],idCard:[{required:!0,message:"请填写身份证号"}],email:[{required:!0,message:"请填写邮箱"}],address:[{required:!0,message:"请填写居住地址"}]}),y=V(),h=u=>{u&&u.validate(async r=>{if(r)try{await t.value.api(t.value.row),me.success({message:`${t.value.title}用户成功！`}),t.value.getTableList(),c.value=!1}catch(w){console.log(w)}})};return l({openDrawer:g}),(u,r)=>{var P;const w=L("Avatar"),S=J,d=re,p=L("Picture"),e=se,i=Oe,n=Ne,f=de,k=G,C=ve;return _(),T(C,{modelValue:c.value,"onUpdate:modelValue":r[9]||(r[9]=b=>c.value=b),"destroy-on-close":"",size:"450px",title:((P=t.value)==null?void 0:P.title)+"用户"},{footer:o(()=>[a(k,{onClick:r[7]||(r[7]=b=>c.value=!1)},{default:o(()=>[U("取消")]),_:1}),ie(a(k,{type:"primary",onClick:r[8]||(r[8]=b=>h(y.value))},{default:o(()=>[U("确定")]),_:1},512),[[ue,!t.value.isView]])]),default:o(()=>[a(f,{ref_key:"ruleFormRef",ref:y,"label-suffix":" ：","label-width":"100px",model:t.value.row,rules:m,disabled:t.value.isView},{default:o(()=>[a(d,{label:"用户头像",prop:"avatar"},{default:o(()=>[a(ja,{imageUrl:t.value.row.avatar,"onUpdate:imageUrl":r[0]||(r[0]=b=>t.value.row.avatar=b),width:"140px",height:"140px","file-size":3},{empty:o(()=>[a(S,null,{default:o(()=>[a(w)]),_:1}),Ga]),tip:o(()=>[U("头像大小不能超过3M")]),_:1},8,["imageUrl"])]),_:1}),a(d,{label:"用户照片",prop:"photo"},{default:o(()=>[a(Ka,{"file-list":t.value.row.photo,"onUpdate:fileList":r[1]||(r[1]=b=>t.value.row.photo=b),height:"135px",width:"135px",borderRadius:"50%"},{empty:o(()=>[a(S,null,{default:o(()=>[a(p)]),_:1}),Ja]),tip:o(()=>[U("照片大小不能超过 5M")]),_:1},8,["file-list"])]),_:1}),a(d,{label:"用户姓名",prop:"username"},{default:o(()=>[a(e,{modelValue:t.value.row.username,"onUpdate:modelValue":r[2]||(r[2]=b=>t.value.row.username=b),placeholder:"请填写用户姓名",clearable:""},null,8,["modelValue"])]),_:1}),a(d,{label:"性别",prop:"gender"},{default:o(()=>[a(n,{modelValue:t.value.row.gender,"onUpdate:modelValue":r[3]||(r[3]=b=>t.value.row.gender=b),placeholder:"请选择性别",clearable:""},{default:o(()=>[(_(!0),D(O,null,te(x(Xa),b=>(_(),T(i,{key:b.value,label:b.label,value:b.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"身份证号",prop:"idCard"},{default:o(()=>[a(e,{modelValue:t.value.row.idCard,"onUpdate:modelValue":r[4]||(r[4]=b=>t.value.row.idCard=b),placeholder:"请填写身份证号",clearable:""},null,8,["modelValue"])]),_:1}),a(d,{label:"邮箱",prop:"email"},{default:o(()=>[a(e,{modelValue:t.value.row.email,"onUpdate:modelValue":r[5]||(r[5]=b=>t.value.row.email=b),placeholder:"请填写邮箱",clearable:""},null,8,["modelValue"])]),_:1}),a(d,{label:"居住地址",prop:"address"},{default:o(()=>[a(e,{modelValue:t.value.row.address,"onUpdate:modelValue":r[6]||(r[6]=b=>t.value.row.address=b),placeholder:"请填写居住地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules","disabled"])]),_:1},8,["modelValue","title"])}}}),Ie=async(s,l,t={},c=!0,g=".xlsx")=>{c&&E({title:"温馨提示",message:"如果数据庞大会导致下载缓慢哦，请耐心等待！",type:"info",duration:3e3});try{const m=await s(t),y=new Blob([m]);if("msSaveOrOpenBlob"in navigator)return window.navigator.msSaveOrOpenBlob(y,l+g);const h=window.URL.createObjectURL(y),u=document.createElement("a");u.style.display="none",u.download=`${l}${g}`,u.href=h,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(h)}catch(m){me.error("下载失败"),console.log("catch",m)}},at=v("div",{class:"el-upload__text"},[U(" 将文件拖到此处，或"),v("em",null,"点击上传")],-1),tt={class:"el-upload__tip"},lt=I({__name:"index",setup(s,{expose:l}){const t=V({title:"",fileSize:5,fileType:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]}),c=V(!1),g=d=>{c.value=!0,t.value={...t.value,...d}},m=()=>{t.value.tempApi&&(Ie(t.value.tempApi,`${t.value.title}模板`),setTimeout(()=>{E({title:"温馨提示",message:"演示环境暂不能导出数据",type:"warning"})},0))},y=async d=>{if(!t.value.importApi)return d.onError();let p=new FormData;p.append("file",d.file),p.append("isCover",S.value),await t.value.importApi(p),t.value.getTableList&&t.value.getTableList(),c.value=!1},h=d=>{const p=t.value.fileType.includes(d.type),e=d.size/1024/1024<t.value.fileSize;return p?e||E({title:"温馨提示",message:`上传文件大小不能超过 ${t.value.fileSize}MB！`,type:"warning"}):E({title:"温馨提示",message:"上传文件只能是 xls / xlsx 格式！",type:"warning"}),p&&e},u=()=>{E({title:"温馨提示",message:"最多只能上传一个文件！",type:"warning"})},r=()=>{E({title:"温馨提示",message:`批量添加${t.value.title}失败，请您重新上传！`,type:"error"})},w=()=>{E({title:"温馨提示",message:`批量添加${t.value.title}成功！`,type:"success"})},S=V(!1);return l({openDialog:g}),(d,p)=>{const e=G,i=re,n=L("upload-filled"),f=J,k=pe,C=ce,P=de,b=We;return _(),T(b,{modelValue:c.value,"onUpdate:modelValue":p[1]||(p[1]=F=>c.value=F),title:`批量添加${t.value.title}`,"destroy-on-close":!0,width:"580px",draggable:""},{default:o(()=>[a(P,null,{default:o(()=>[a(i,{label:"模板下载 :"},{default:o(()=>[a(e,{type:"primary",icon:"Download",onClick:m},{default:o(()=>[U(" 点击下载 ")]),_:1})]),_:1}),a(i,{label:"文件上传 :"},{default:o(()=>[a(k,{action:"#",class:"upload",drag:!0,limit:1,multiple:!0,"show-file-list":!0,"http-request":y,"before-upload":h,"on-exceed":u,"on-success":w,"on-error":r,accept:t.value.fileType.join(",")},{tip:o(()=>[B(d.$slots,"tip",{},()=>[v("div",tt," 请上传 .xls , .xlsx 标准格式文件，文件最大为 "+ae(t.value.fileSize)+"M ",1)])]),default:o(()=>[B(d.$slots,"empty",{},()=>[a(f,{class:"el-icon--upload"},{default:o(()=>[a(n)]),_:1}),at])]),_:3},8,["accept"])]),_:3}),a(i,{label:"数据覆盖 :"},{default:o(()=>[a(C,{modelValue:S.value,"onUpdate:modelValue":p[0]||(p[0]=F=>S.value=F)},null,8,["modelValue"])]),_:1})]),_:3})]),_:3},8,["modelValue","title"])}}}),Q=(s,l={},t,c="warning")=>new Promise((g,m)=>{Ve.confirm(`是否${t}?`,"温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:c,draggable:!0}).then(async()=>{await s(l),g(!0),me({type:"success",message:`${t}成功!`})}).catch(()=>{})}),ot={class:"table-box"},nt=I({name:"useProTable"}),st=I({...nt,setup(s){const l=V(null),t=[{type:"selection",fixed:"left",width:55,showOverflowTooltip:!1},{prop:"username",label:"用户姓名",minWidth:120,search:{el:"input",tooltip:"筛选用户姓名",props:{placeholder:"请输入用户姓名"}}},{prop:"gender",label:"性别",minWidth:120,search:{el:"select",isCollapsed:!0,props:{placeholder:"请选择性别"},option:[{label:"男",value:1},{label:"女",value:2}]},render:e=>e.row.gender==1?"男":"女"},{prop:"age",label:"年龄",minWidth:120,search:{render:({searchParam:e})=>a("div",{class:"condition-main"},[a(se,{modelValue:e.minAge,"onUpdate:modelValue":i=>e.minAge=i,placeholder:"最小年龄"},null),a("span",{class:"mr10 ml10"},[U("-")]),a(se,{modelValue:e.maxAge,"onUpdate:modelValue":i=>e.maxAge=i,placeholder:"最大年龄"},null)]),isCollapsed:!0},render:e=>e.row.user.detail.age},{prop:"idCard",label:"身份证号",minWidth:120,search:{el:"input",isCollapsed:!0,props:{placeholder:"请输入身份证号"}}},{prop:"email",label:"邮箱",minWidth:120},{prop:"address",label:"居住地址",minWidth:120},{prop:"status",slotRender:"status",label:"用户状态",minWidth:120,search:{el:"select",placeholder:"请选择用户状态",isCollapsed:!0,option:[{label:"启用",value:1},{label:"禁用",value:0}]}},{prop:"createTime",label:"创建时间",minWidth:120,search:{render:({searchParam:e})=>a(Ye,{modelValue:e.createTime,"onUpdate:modelValue":i=>e.createTime=i,"value-format":"YYYY-MM-DD HH:mm:ss",clearable:!1,type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},null),defaultValue:["2022-11-12 11:35:00","2022-12-12 11:35:00"],isFullWidth:!0,isCollapsed:!0}},{fixed:"right",label:"操作",width:330,slotRender:"operation"}],c=He(),g=()=>{c.replace({path:`/proTable/useProTable/detail/${Math.floor(Math.random()*100)}`,query:{params:"detail-page"}})},m=V(null),y=()=>{var i,n;const e={title:"用户",tempApi:he,importApi:ha,getTableList:(i=l.value)==null?void 0:i.getTableList};(n=m.value)==null||n.openDialog(e)},h=async()=>{Ve.confirm("确认导出用户数据?","温馨提示",{type:"warning"}).then(()=>{var e;return Ie(he,"用户列表",(e=l.value)==null?void 0:e.searchParam)}).catch(()=>{})},u=async e=>{var i,n;await Q(ge,{id:e},"删除所选用户信息"),(i=l.value)==null||i.clearSelection(),(n=l.value)==null||n.getTableList()},r=async e=>{var i;await Q(ge,{id:[e.id]},`删除【${e.username}】用户`),(i=l.value)==null||i.getTableList()},w=async e=>{await Q(ba,{id:e.id},`重置【${e.username}】用户密码`)},S=async e=>await Q(ya,{id:e.id,status:e.status==1?0:1},`切换【${e.username}】用户状态`),d=V(),p=(e,i={})=>{var f;const n={title:e,row:{...i},isView:e==="查看",api:e==="新增"?ga:e==="编辑"?va:void 0,getTableList:(f=l.value)==null?void 0:f.getTableList};d.value.openDrawer(n)};return(e,i)=>{const n=G,f=ce,k=Da;return _(),D("div",ot,[a(k,{ref_key:"proTableRef",ref:l,columns:t},{tableHeader:o(C=>[a(n,{type:"primary",icon:"CirclePlus",onClick:i[0]||(i[0]=P=>p("新增"))},{default:o(()=>[U(" 新增用户 ")]),_:1}),a(n,{type:"primary",icon:"Upload",plain:"",onClick:y},{default:o(()=>[U(" 批量添加用户 ")]),_:1}),a(n,{type:"primary",icon:"Download",plain:"",onClick:h},{default:o(()=>[U(" 导出用户数据 ")]),_:1}),a(n,{type:"primary",plain:"",onClick:g},{default:o(()=>[U(" To 子集详情页面 ")]),_:1}),a(n,{type:"danger",icon:"Delete",plain:"",disabled:C.isDisabled,onClick:P=>u(C.selectedListIds)},{default:o(()=>[U(" 批量删除用户 ")]),_:2},1032,["disabled","onClick"])]),status:o(C=>[a(f,{modelValue:C.row.status,"onUpdate:modelValue":P=>C.row.status=P,"before-change":()=>S(C.row),"inline-prompt":"","active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue","onUpdate:modelValue","before-change"])]),operation:o(C=>[a(n,{link:"",type:"primary",size:"small",icon:"View",onClick:P=>p("查看",C.row)},{default:o(()=>[U(" 查看 ")]),_:2},1032,["onClick"]),a(n,{link:"",type:"primary",size:"small",icon:"EditPen",onClick:P=>p("编辑",C.row)},{default:o(()=>[U(" 编辑 ")]),_:2},1032,["onClick"]),a(n,{link:"",type:"primary",size:"small",icon:"Refresh",onClick:P=>w(C.row)},{default:o(()=>[U(" 重置密码 ")]),_:2},1032,["onClick"]),a(n,{link:"",type:"primary",size:"small",icon:"Delete",onClick:P=>r(C.row)},{default:o(()=>[U(" 删除 ")]),_:2},1032,["onClick"])]),_:1},512),a(et,{ref_key:"drawerRef",ref:d},null,512),a(lt,{ref_key:"dialogRef",ref:m},null,512)])}}}),bt=M(st,[["__scopeId","data-v-a3f4f0d8"]]);export{bt as default};
